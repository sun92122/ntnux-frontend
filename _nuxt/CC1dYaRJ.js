import{u as A}from"./C0of1JiW.js";import{D as y,r as b,v as w,A as i,G as S,J as D,B as r,H as l,W as g,x as v,M as E,N as U,R as j,y as s,z as h,L as k,S as z,C as H,a8 as T}from"./BJj5iVno.js";import _ from"./B1Qt6FQD.js";import R from"./YDtsCE2J.js";import G from"./Bcjbu909.js";import I from"./DHxCLLAQ.js";import"./BZBzL4Iq.js";import"./E_Zstz1X.js";import"./CZqt62L9.js";import"./DmAKcFyP.js";const J={class:"container"},M={style:{display:"flex","align-items":"center","justify-content":"space-between"}},P={class:"p-d-flex p-flex-column p-ai-center"},oe={__name:"favorite",setup(W){const{selectCode:m}=A(),x=y("selectionCodeDatas",()=>[]),p=y("selectionCodeNotFound",()=>[]),u=y("tsvDatas",()=>[]),d=b(!1),a=b(""),$=b(["學年度","開課系所代碼","開課系所名稱","科目代碼","科目中文名稱","科目英文名稱","必選修","上學期學分","下學期學分","停開"]);async function C(){var f;if(((f=u==null?void 0:u.value)==null?void 0:f.length)<1){const t=(await(await fetch("./data/113.tsv")).text()).replace(/\r/g,"").trim().split(`
`),o=t[0].split("	");for(let n=0;n<o.length;n++)o[n]=o[n].trim();for(;o[-1]==="";)o.pop();const F=t.slice(1).map(n=>{const V={};return n.split("	").forEach((B,L)=>V[o[L]]=B.trim()),V});u.value=F}x.value=u.value.filter(e=>[...m.value].includes(e.科目代碼)),p.value=[...m.value].filter(e=>!x.value.some(c=>c.科目代碼===e))}function N(){a.value.split(/[\s,，、\n]+/).filter(e=>e.trim()!=="").forEach(e=>{m.value.includes(e)||m.value.push(e)}),a.value="",d.value=!1,C()}return C(),(f,e)=>{var c;return v(),w("div",J,[i(l(z),{value:l(x),class:"p-datatable-striped"},{header:r(()=>[s("div",M,[e[6]||(e[6]=s("span",null,"收藏課程",-1)),i(l(k),{icon:"pi pi-file-import",label:"匯入收藏課程",class:"p-button-text p-button-secondary",onClick:e[0]||(e[0]=t=>d.value=!0)})])]),empty:r(()=>e[7]||(e[7]=[s("div",{class:"flex align-items-center justify-content-center"},[s("i",{class:"pi pi-exclamation-triangle mr-2"}),s("span",null,"沒有收藏的課程")],-1)])),default:r(()=>[(v(!0),w(E,null,U(l($),t=>(v(),S(l(j),{key:t,field:t,header:t,sortable:!0,style:{textAlign:"center"}},{body:r(({data:o})=>[s("span",null,h(o[t]),1)]),_:2},1032,["field","header"]))),128))]),_:1},8,["value"]),((c=l(p))==null?void 0:c.length)>0?(v(),S(l(_),{key:0,modelValue:l(p),"onUpdate:modelValue":e[1]||(e[1]=t=>g(p)?p.value=t:null),listStyle:{height:"calc(100vh - 200px)"},style:{width:"100%"},header:"未找到的收藏課程",itemStyle:{textAlign:"center"},buttonProps:{style:{display:"none"}}},{option:r(({option:t})=>[H(h(t),1)]),_:1},8,["modelValue"])):D("",!0),i(l(T),{visible:l(d),"onUpdate:visible":e[5]||(e[5]=t=>g(d)?d.value=t:null),header:"匯入收藏課程",modal:"",style:{width:"50vw"},"content-style":{margin:"0 0 1rem"},footer:null},{default:r(()=>[s("div",P,[i(l(R),{variant:"in"},{default:r(()=>[i(l(G),{id:"import_textarea",modelValue:l(a),"onUpdate:modelValue":e[2]||(e[2]=t=>g(a)?a.value=t:null),rows:"5",cols:"50",style:{resize:"none"}},null,8,["modelValue"]),e[8]||(e[8]=s("label",{for:"import_textarea",style:{color:"var(--p-floatlabel-color)"}},"複數科目代碼以空格、換行、逗號或頓號隔開",-1))]),_:1}),i(l(I),{class:"p-mt-3",name:"file",accept:".txt,.tsv",auto:!0,maxFileSize:1e6,chooseLabel:"選擇檔案",uploadLabel:"上傳檔案",cancelLabel:"取消",onUpload:e[3]||(e[3]=t=>{a.value+=t.files[0].text}),onError:e[4]||(e[4]=t=>{a.value="",console.error("File upload error:",t)})}),i(l(k),{label:"匯入",icon:"pi pi-check",class:"p-button-text p-button-secondary",onClick:N})])]),_:1},8,["visible"])])}}};export{oe as default};
